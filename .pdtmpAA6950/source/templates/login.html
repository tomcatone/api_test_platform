<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>登錄 — API 測試平台</title>
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
<style>
  * { box-sizing: border-box; }
  body {
    margin: 0; min-height: 100vh;
    background: linear-gradient(135deg, #1e3a5f 0%, #0f2027 50%, #1a1a2e 100%);
    display: flex; align-items: center; justify-content: center;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  }
  .login-wrap {
    width: 100%; max-width: 400px; padding: 16px;
  }
  .login-card {
    background: rgba(255,255,255,.06);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(255,255,255,.12);
    border-radius: 16px;
    padding: 40px 36px 32px;
    box-shadow: 0 25px 60px rgba(0,0,0,.4);
  }
  .brand {
    text-align: center; margin-bottom: 32px;
  }
  .brand-icon {
    width: 64px; height: 64px; border-radius: 16px;
    background: linear-gradient(135deg, #3b82f6, #8b5cf6);
    display: flex; align-items: center; justify-content: center;
    font-size: 28px; color: #fff; margin: 0 auto 14px;
    box-shadow: 0 8px 24px rgba(59,130,246,.4);
  }
  .brand h1 { color: #fff; font-size: 1.3rem; font-weight: 700; margin: 0; }
  .brand p  { color: rgba(255,255,255,.5); font-size: .82rem; margin: 4px 0 0; }
  .form-label { color: rgba(255,255,255,.75); font-size: .85rem; margin-bottom: 6px; }
  .form-control {
    background: rgba(255,255,255,.08);
    border: 1px solid rgba(255,255,255,.15);
    color: #fff; border-radius: 8px; padding: 10px 14px;
    transition: border-color .2s, box-shadow .2s;
  }
  .form-control:focus {
    background: rgba(255,255,255,.12);
    border-color: #3b82f6;
    box-shadow: 0 0 0 3px rgba(59,130,246,.25);
    color: #fff; outline: none;
  }
  .form-control::placeholder { color: rgba(255,255,255,.3); }
  .input-group-text {
    background: rgba(255,255,255,.08);
    border: 1px solid rgba(255,255,255,.15);
    border-right: none; color: rgba(255,255,255,.5);
  }
  .input-group .form-control { border-left: none; }
  .btn-login {
    width: 100%; padding: 11px;
    background: linear-gradient(135deg, #3b82f6, #6366f1);
    border: none; border-radius: 8px; color: #fff;
    font-weight: 600; font-size: .95rem; cursor: pointer;
    transition: opacity .2s, transform .15s;
    margin-top: 8px;
  }
  .btn-login:hover { opacity: .9; transform: translateY(-1px); }
  .btn-login:active { transform: translateY(0); }
  .btn-login:disabled { opacity: .6; cursor: not-allowed; transform: none; }
  .alert-err {
    background: rgba(239,68,68,.15); border: 1px solid rgba(239,68,68,.3);
    color: #fca5a5; border-radius: 8px; padding: 10px 14px;
    font-size: .85rem; display: none; margin-bottom: 16px;
  }
  .footer-text { text-align: center; color: rgba(255,255,255,.3); font-size: .75rem; margin-top: 24px; }
</style>
</head>
<body>
<div class="login-wrap">
  <div class="login-card">
    <div class="brand">
      <div class="brand-icon"><i class="fas fa-flask"></i></div>
      <h1>API 測試平台</h1>
      <p>v3 · 請登錄以繼續</p>
    </div>

    <div class="alert-err" id="errMsg"></div>

    <div class="mb-3">
      <label class="form-label">用戶名</label>
      <div class="input-group">
        <span class="input-group-text"><i class="fas fa-user fa-sm"></i></span>
        <input type="text" class="form-control" id="username" placeholder="請輸入用戶名" autofocus>
      </div>
    </div>
    <div class="mb-4">
      <label class="form-label">密碼</label>
      <div class="input-group">
        <span class="input-group-text"><i class="fas fa-lock fa-sm"></i></span>
        <input type="password" class="form-control" id="password" placeholder="請輸入密碼">
      </div>
    </div>

    <button class="btn-login" id="loginBtn" onclick="doLogin()">
      <i class="fas fa-sign-in-alt me-2"></i>登 錄
    </button>
  </div>
  <div class="footer-text">API Test Platform · 僅供內部使用</div>
</div>

<script>
document.addEventListener('keydown', e => { if (e.key === 'Enter') doLogin(); });

async function doLogin() {
  const username = document.getElementById('username').value.trim();
  const password = document.getElementById('password').value;
  const btn = document.getElementById('loginBtn');
  const err = document.getElementById('errMsg');
  err.style.display = 'none';

  if (!username || !password) {
    err.textContent = '請填寫用戶名和密碼';
    err.style.display = 'block';
    return;
  }

  btn.disabled = true;
  btn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>登錄中...';

  try {
    const res = await fetch('/api/auth/login/', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ username, password }),
      credentials: 'same-origin',
    });
    const data = await res.json();
    if (data.code === 0) {
      window.location.href = '/';
    } else {
      err.textContent = data.message || '登錄失敗';
      err.style.display = 'block';
    }
  } catch(e) {
    err.textContent = '網絡錯誤，請重試';
    err.style.display = 'block';
  } finally {
    btn.disabled = false;
    btn.innerHTML = '<i class="fas fa-sign-in-alt me-2"></i>登 錄';
  }
}
</script>
</body>
</html>
